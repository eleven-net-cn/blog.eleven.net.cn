
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ImageTools 指南 - Eleven 的博客</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Eleven,eleven-net-cn,Frontend,"> 
    <meta name="description" content="
基于 vite-imagetools 的图片优化解决方案，官方的文档太过于简单，因此，借助 AI 整理了完整有效的使用指南。
当前文档适用版本 vite-imagetools 6.2.9

📖 ,"> 
    <meta name="author" content="eleven-net-cn"> 
    <link rel="alternative" href="atom.xml" title="Eleven 的博客" type="application/atom+xml"> 
    <link rel="icon" href="/img/abc/eleven-net-cn.jpeg"> 
    
<link rel="stylesheet" href="/css/font_1429596_nzgqgvnmkjb.css">

    
<link rel="stylesheet" href="/css/animate.min.css">

    
<link rel="stylesheet" href="/css/share-1.0.16.min.css">

    
<link rel="stylesheet" href="/codemirror-5.60.0/lib/codemirror.css">

    
<link rel="stylesheet" href="/codemirror-5.60.0/theme/dracula.css">

    
<link rel="stylesheet" href="/css/obsidian.css">

    
<link rel="stylesheet" href="/css/ball-atom.min.css">

    
<meta name="generator" content="Hexo 5.4.0"></head>


<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Eleven 的博客</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block">
  <div class="bar" style="width: 0"></div>
  <div class="navigation animated fadeIn fast delay-1s">
    <img
      id="home-icon"
      class="icon-home"
      src="/img/abc/eleven-net-cn.jpeg"
      alt=""
      data-url="https://blog.eleven.net.cn"
    />
    <div id="play-icon" title="播放/暂停" class="iconfont icon-play"></div>
    <div id="play-next" title="下一曲" class="iconfont icon-next icon-arrow-right- next"></div>
    <h3 class="subtitle">ImageTools 指南</h3>
    <div class="social">
      <!--        <div class="like-icon">-->
      <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
      <!--        </div>-->
      <div>
        <div class="share">
          
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.1), #100e17),
                url(/img/welcome-cover.jpg) ">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="/categories/Vite"><b>「
                    </b>VITE<b> 」</b></a>
                
                八月 26, 2025
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/2025/08/26/vite/imagetools/" title="ImageTools 指南" class="">ImageTools 指南</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>文章字数</i>
                    26k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>阅读约需</i>
                    24 mins.
                </span>
                
                
                <span id="/2025/08/26/vite/imagetools/" class="leancloud_visitors" data-flag-title="ImageTools 指南">
                    <b class="iconfont icon-read"></b> <i>阅读次数</i>
                    <span class="leancloud-visitors-count">--</span>
                </span>
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list" itemprop="keywords"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Vite/" rel="tag">Vite</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96/" rel="tag">图片优化</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" rel="tag">性能优化</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <blockquote>
<p>基于 <a target="_blank" rel="noopener" href="https://github.com/JonasKruckenberg/imagetools">vite-imagetools</a> 的图片优化解决方案，官方的文档太过于简单，因此，借助 AI 整理了完整有效的使用指南。</p>
<p>当前文档适用版本 vite-imagetools 6.2.9</p>
</blockquote>
<h2 id="📖-简介"><a href="#📖-简介" class="headerlink" title="📖 简介"></a>📖 简介</h2><p>ImageTools 是一个强大的 Vite 插件，专门负责重要图片的格式转换（PNG/JPG → WebP/AVIF），通过查询参数的方式在构建时对图片进行优化处理。</p>
<p><strong>⚠️ 重要提醒</strong>：图片必须通过 <code>import</code> 导入，才能让 imagetools 插件工作生效。</p>
<h2 id="⚙️-插件配置参数"><a href="#⚙️-插件配置参数" class="headerlink" title="⚙️ 插件配置参数"></a>⚙️ 插件配置参数</h2><h3 id="include-文件包含规则"><a href="#include-文件包含规则" class="headerlink" title="include - 文件包含规则"></a><code>include</code> - 文件包含规则</h3><p><strong>作用</strong>：决定哪些文件会被 imagetools 插件处理<br><strong>类型</strong>：<code>string | RegExp | Array&lt;string | RegExp&gt;</code><br><strong>默认值</strong>：<code>&#39;**/*.(heif,avif,jpeg,jpg,png,tiff,webp,gif)?*&#39;</code></p>
<pre><code class="typescript">imagetools(&#123;
  // 只处理 assets 目录下的图片
  include: &#39;src/assets/**/*.&#123;jpg,jpeg,png,webp&#125;&#39;,

  // 或使用正则表达式
  include: /^.*\.(jpg|jpeg|png|webp)$/,

  // 或使用数组处理多个规则
  include: [&#39;src/assets/**/*.&#123;jpg,jpeg,png&#125;&#39;, &#39;src/images/**/*.webp&#39;],
&#125;)</code></pre>
<p><strong>编译结果影响</strong>：</p>
<ul>
<li>✅ 匹配的文件：会被 imagetools 处理，支持查询参数</li>
<li>❌ 不匹配的文件：直接复制到 dist，不支持查询参数</li>
</ul>
<h3 id="exclude-文件排除规则"><a href="#exclude-文件排除规则" class="headerlink" title="exclude - 文件排除规则"></a><code>exclude</code> - 文件排除规则</h3><p><strong>作用</strong>：指定哪些文件不被 imagetools 处理，即使匹配了 include<br><strong>类型</strong>：<code>string | RegExp | Array&lt;string | RegExp&gt;</code><br><strong>默认值</strong>：<code>&#39;public/**/*&#39;</code></p>
<pre><code class="typescript">imagetools(&#123;
  exclude: [
    &#39;public/**/*&#39;, // 排除 public 目录
    &#39;src/assets/icons/**/*&#39;, // 排除图标目录
    /.*\.svg$/, // 排除所有 SVG 文件
  ],
&#125;)</code></pre>
<p><strong>编译结果影响</strong>：</p>
<ul>
<li>被排除的文件不会被处理，即使路径匹配 <code>include</code> 规则</li>
<li>这些文件会按照 Vite 的默认规则处理</li>
</ul>
<h3 id="defaultDirectives-默认处理指令"><a href="#defaultDirectives-默认处理指令" class="headerlink" title="defaultDirectives - 默认处理指令"></a><code>defaultDirectives</code> - 默认处理指令</h3><p><strong>作用</strong>：为所有图片设置默认的处理参数<br><strong>类型</strong>：<code>URLSearchParams | ((url: URL, metadata: () =&gt; Promise&lt;Metadata&gt;) =&gt; URLSearchParams)</code></p>
<h4 id="静态配置方式："><a href="#静态配置方式：" class="headerlink" title="静态配置方式："></a>静态配置方式：</h4><pre><code class="typescript">imagetools(&#123;
  defaultDirectives: new URLSearchParams(&#123;
    format: &#39;webp&#39;, // 默认转换为 WebP
    quality: &#39;85&#39;, // 默认质量 85%
    progressive: &#39;true&#39;, // 默认启用渐进式加载
  &#125;),
&#125;)</code></pre>
<h4 id="动态配置方式："><a href="#动态配置方式：" class="headerlink" title="动态配置方式："></a>动态配置方式：</h4><pre><code class="typescript">imagetools(&#123;
  defaultDirectives: (url, metadata) =&gt; &#123;
    const params = new URLSearchParams()

    // 根据文件路径设置不同默认值
    if (url.pathname.includes(&#39;/hero/&#39;)) &#123;
      params.set(&#39;format&#39;, &#39;webp&#39;)
      params.set(&#39;quality&#39;, &#39;90&#39;)
      params.set(&#39;w&#39;, &#39;1920&#39;)
    &#125; else if (url.pathname.includes(&#39;/thumb/&#39;)) &#123;
      params.set(&#39;format&#39;, &#39;webp&#39;)
      params.set(&#39;quality&#39;, &#39;75&#39;)
      params.set(&#39;w&#39;, &#39;300&#39;)
      params.set(&#39;h&#39;, &#39;300&#39;)
      params.set(&#39;fit&#39;, &#39;cover&#39;)
    &#125; else &#123;
      params.set(&#39;format&#39;, &#39;webp&#39;)
      params.set(&#39;quality&#39;, &#39;85&#39;)
    &#125;

    return params
  &#125;,
&#125;)</code></pre>
<p><strong>编译结果影响</strong>：</p>
<ul>
<li>默认指令会与查询参数合并，查询参数优先级更高</li>
<li>如果没有查询参数，会使用默认指令处理</li>
</ul>
<h3 id="removeMetadata-移除元数据"><a href="#removeMetadata-移除元数据" class="headerlink" title="removeMetadata - 移除元数据"></a><code>removeMetadata</code> - 移除元数据</h3><p><strong>作用</strong>：是否移除图片的 EXIF、GPS、作者等隐私信息<br><strong>类型</strong>：<code>boolean</code><br><strong>默认值</strong>：<code>true</code></p>
<pre><code class="typescript">imagetools(&#123;
  removeMetadata: true, // 移除元数据，减小文件大小
&#125;)</code></pre>
<p><strong>编译结果影响</strong>：</p>
<ul>
<li><code>true</code>：移除所有元数据，文件更小，保护隐私</li>
<li><code>false</code>：保留元数据，文件稍大，保留原始信息</li>
</ul>
<h3 id="namedExports-命名导出"><a href="#namedExports-命名导出" class="headerlink" title="namedExports - 命名导出"></a><code>namedExports</code> - 命名导出</h3><p><strong>作用</strong>：是否生成命名导出（如 srcset、metadata）<br><strong>类型</strong>：<code>boolean</code><br><strong>默认值</strong>：<code>undefined</code></p>
<pre><code class="typescript">imagetools(&#123;
  namedExports: true,
&#125;)</code></pre>
<p><strong>编译结果影响</strong>：</p>
<pre><code class="typescript">// namedExports: true 时
import img, &#123; srcset, metadata &#125; from &#39;./pic.jpg?w=400;800&amp;as=srcset&#39;

// namedExports: false 时
import img from &#39;./pic.jpg?w=400;800&amp;as=srcset&#39; // 只有默认导出</code></pre>
<h2 id="🎯-查询参数详解"><a href="#🎯-查询参数详解" class="headerlink" title="🎯 查询参数详解"></a>🎯 查询参数详解</h2><h3 id="尺寸控制参数"><a href="#尺寸控制参数" class="headerlink" title="尺寸控制参数"></a>尺寸控制参数</h3><h4 id="w-宽度设置"><a href="#w-宽度设置" class="headerlink" title="w - 宽度设置"></a><code>w</code> - 宽度设置</h4><p><strong>作用</strong>：设置输出图片的宽度（像素）</p>
<pre><code class="typescript">// 单一宽度
import img from &#39;./pic.jpg?w=400&#39;
// 编译结果：生成 400px 宽的图片

// 多个宽度（响应式）
import img from &#39;./pic.jpg?w=400;800;1200&#39;
// 编译结果：生成 3 个不同宽度的图片文件</code></pre>
<h4 id="h-高度设置"><a href="#h-高度设置" class="headerlink" title="h - 高度设置"></a><code>h</code> - 高度设置</h4><p><strong>作用</strong>：设置输出图片的高度（像素）</p>
<pre><code class="typescript">import img from &#39;./pic.jpg?h=300&#39;
// 编译结果：生成 300px 高的图片，宽度按比例缩放

import img from &#39;./pic.jpg?w=400&amp;h=300&#39;
// 编译结果：生成 400x300 的图片，可能会裁剪</code></pre>
<h4 id="aspect-宽高比"><a href="#aspect-宽高比" class="headerlink" title="aspect - 宽高比"></a><code>aspect</code> - 宽高比</h4><p><strong>作用</strong>：强制设置图片的宽高比<br><strong>格式</strong>：<code>16:9</code>、<code>4:3</code>、<code>1:1</code> 等</p>
<pre><code class="typescript">import img from &#39;./pic.jpg?w=400&amp;aspect=16:9&#39;
// 编译结果：生成 400x225 的图片（16:9 比例）</code></pre>
<h4 id="fit-适配模式"><a href="#fit-适配模式" class="headerlink" title="fit - 适配模式"></a><code>fit</code> - 适配模式</h4><p><strong>作用</strong>：当指定了宽度和高度时，决定如何处理图片以适应目标尺寸</p>
<pre><code class="typescript">// cover：裁剪填满（默认）
import cover from &#39;./pic.jpg?w=400&amp;h=300&amp;fit=cover&#39;
// 编译结果：400x300，可能裁剪图片边缘

// contain：完整显示
import contain from &#39;./pic.jpg?w=400&amp;h=300&amp;fit=contain&#39;
// 编译结果：图片完整显示在 400x300 区域内，可能有空白

// fill：拉伸填满
import fill from &#39;./pic.jpg?w=400&amp;h=300&amp;fit=fill&#39;
// 编译结果：强制拉伸到 400x300，可能变形

// inside：缩小到区域内
import inside from &#39;./pic.jpg?w=400&amp;h=300&amp;fit=inside&#39;
// 编译结果：只缩小，不放大

// outside：放大到覆盖区域
import outside from &#39;./pic.jpg?w=400&amp;h=300&amp;fit=outside&#39;
// 编译结果：放大到完全覆盖区域</code></pre>
<h4 id="position-裁剪位置"><a href="#position-裁剪位置" class="headerlink" title="position - 裁剪位置"></a><code>position</code> - 裁剪位置</h4><p><strong>作用</strong>：当使用 <code>fit=cover</code> 时，指定从图片的哪个部分开始裁剪</p>
<pre><code class="typescript">import img from &#39;./pic.jpg?w=400&amp;h=300&amp;fit=cover&amp;position=top&#39;
// 编译结果：从图片顶部开始裁剪

// 可选值：top, right, bottom, left, center
// 也可以组合：top left, bottom right 等</code></pre>
<h3 id="格式转换参数"><a href="#格式转换参数" class="headerlink" title="格式转换参数"></a>格式转换参数</h3><h4 id="format-输出格式"><a href="#format-输出格式" class="headerlink" title="format - 输出格式"></a><code>format</code> - 输出格式</h4><p><strong>作用</strong>：转换图片格式<br><strong>支持格式</strong>：<code>webp</code>、<code>avif</code>、<code>jpeg</code>、<code>jpg</code>、<code>png</code>、<code>tiff</code>、<code>gif</code>、<code>heif</code></p>
<pre><code class="typescript">// 单一格式
import webp from &#39;./pic.jpg?format=webp&#39;
// 编译结果：生成 .webp 文件

// 多格式输出
import multi from &#39;./pic.jpg?format=webp;avif;jpg&#39;
// 编译结果：生成 3 个不同格式的文件</code></pre>
<h4 id="quality-图片质量"><a href="#quality-图片质量" class="headerlink" title="quality - 图片质量"></a><code>quality</code> - 图片质量</h4><p><strong>作用</strong>：设置有损压缩的质量<br><strong>范围</strong>：0-100<br><strong>适用格式</strong>：JPEG、WebP（有损模式）、AVIF</p>
<pre><code class="typescript">import high from &#39;./pic.jpg?format=webp&amp;quality=95&#39;
// 编译结果：高质量 WebP（文件较大）

import low from &#39;./pic.jpg?format=webp&amp;quality=60&#39;
// 编译结果：低质量 WebP（文件较小）</code></pre>
<p><strong>推荐质量设置</strong>：</p>
<ul>
<li><strong>WebP</strong>: <code>quality=85</code> 是视觉无损的最佳平衡点</li>
<li><strong>AVIF</strong>: <code>quality=80</code> 提供更好的压缩率</li>
</ul>
<h4 id="progressive-渐进式加载"><a href="#progressive-渐进式加载" class="headerlink" title="progressive - 渐进式加载"></a><code>progressive</code> - 渐进式加载</h4><p><strong>作用</strong>：生成支持渐进式加载的图片<br><strong>支持格式</strong>：只有 JPEG</p>
<pre><code class="typescript">import prog from &#39;./pic.jpg?format=jpeg&amp;progressive=true&#39;
// 编译结果：生成渐进式 JPEG，支持逐步加载显示</code></pre>
<h4 id="lossless-无损压缩"><a href="#lossless-无损压缩" class="headerlink" title="lossless - 无损压缩"></a><code>lossless</code> - 无损压缩</h4><p><strong>作用</strong>：对支持的格式使用无损压缩<br><strong>支持格式</strong>：WebP、PNG</p>
<pre><code class="typescript">import lossless from &#39;./pic.png?format=webp&amp;lossless=true&#39;
// 编译结果：生成无损 WebP，质量完美但文件较大</code></pre>
<h3 id="视觉效果参数"><a href="#视觉效果参数" class="headerlink" title="视觉效果参数"></a>视觉效果参数</h3><h4 id="blur-模糊效果"><a href="#blur-模糊效果" class="headerlink" title="blur - 模糊效果"></a><code>blur</code> - 模糊效果</h4><p><strong>作用</strong>：应用高斯模糊<br><strong>范围</strong>：0.3-1000（实际常用 1-20）</p>
<pre><code class="typescript">import blurred from &#39;./pic.jpg?blur=5&#39;
// 编译结果：应用 5px 半径的高斯模糊

// 常用值：1-10，数值越大越模糊</code></pre>
<h4 id="grayscale-灰度转换"><a href="#grayscale-灰度转换" class="headerlink" title="grayscale - 灰度转换"></a><code>grayscale</code> - 灰度转换</h4><p><strong>作用</strong>：转换为灰度图片</p>
<pre><code class="typescript">import gray from &#39;./pic.jpg?grayscale=true&#39;
// 编译结果：转换为灰度图片</code></pre>
<h4 id="invert-颜色反转"><a href="#invert-颜色反转" class="headerlink" title="invert - 颜色反转"></a><code>invert</code> - 颜色反转</h4><p><strong>作用</strong>：反转所有颜色（类似底片效果）</p>
<pre><code class="typescript">import inverted from &#39;./pic.jpg?invert=true&#39;
// 编译结果：反转所有颜色</code></pre>
<h4 id="tint-色调调整"><a href="#tint-色调调整" class="headerlink" title="tint - 色调调整"></a><code>tint</code> - 色调调整</h4><p><strong>作用</strong>：给图片添加颜色色调<br><strong>格式</strong>：十六进制颜色值（不需要 # 前缀）</p>
<pre><code class="typescript">import tinted from &#39;./pic.jpg?tint=ff0000&#39;
// 编译结果：添加红色色调

// 使用十六进制颜色值，不需要 # 前缀</code></pre>
<h4 id="rotate-旋转"><a href="#rotate-旋转" class="headerlink" title="rotate - 旋转"></a><code>rotate</code> - 旋转</h4><p><strong>作用</strong>：旋转图片<br><strong>范围</strong>：任意角度</p>
<pre><code class="typescript">import rotated from &#39;./pic.jpg?rotate=90&#39;
// 编译结果：顺时针旋转 90 度

// 支持任意角度，负数表示逆时针</code></pre>
<h4 id="flip-flop-翻转"><a href="#flip-flop-翻转" class="headerlink" title="flip / flop - 翻转"></a><code>flip</code> / <code>flop</code> - 翻转</h4><p><strong>作用</strong>：翻转图片</p>
<pre><code class="typescript">import flipped from &#39;./pic.jpg?flip=true&#39;
// 编译结果：水平翻转（左右翻转）

import flopped from &#39;./pic.jpg?flop=true&#39;
// 编译结果：垂直翻转（上下翻转）</code></pre>
<h3 id="高级参数"><a href="#高级参数" class="headerlink" title="高级参数"></a>高级参数</h3><h4 id="background-背景色"><a href="#background-背景色" class="headerlink" title="background - 背景色"></a><code>background</code> - 背景色</h4><p><strong>作用</strong>：为透明区域或空白区域设置背景色</p>
<pre><code class="typescript">import withBg from &#39;./pic.png?w=400&amp;h=300&amp;fit=contain&amp;background=ffffff&#39;
// 编译结果：透明区域或空白区域填充白色

// 用于 PNG 转 JPEG 时移除透明度</code></pre>
<h4 id="flatten-图层合并"><a href="#flatten-图层合并" class="headerlink" title="flatten - 图层合并"></a><code>flatten</code> - 图层合并</h4><p><strong>作用</strong>：将透明图层合并到背景上</p>
<pre><code class="typescript">import flattened from &#39;./pic.png?flatten=true&amp;background=ffffff&#39;
// 编译结果：将透明图层合并到白色背景上</code></pre>
<h4 id="normalize-归一化"><a href="#normalize-归一化" class="headerlink" title="normalize - 归一化"></a><code>normalize</code> - 归一化</h4><p><strong>作用</strong>：增强图片对比度</p>
<pre><code class="typescript">import normalized from &#39;./pic.jpg?normalize=true&#39;
// 编译结果：增强图片对比度，拉伸亮度分布</code></pre>
<h4 id="median-中值滤波"><a href="#median-中值滤波" class="headerlink" title="median - 中值滤波"></a><code>median</code> - 中值滤波</h4><p><strong>作用</strong>：去除图片噪点</p>
<pre><code class="typescript">import filtered from &#39;./pic.jpg?median=3&#39;
// 编译结果：应用 3x3 中值滤波，去除噪点</code></pre>
<h2 id="📤-输出格式详解"><a href="#📤-输出格式详解" class="headerlink" title="📤 输出格式详解"></a>📤 输出格式详解</h2><h3 id="默认输出（URL-字符串）"><a href="#默认输出（URL-字符串）" class="headerlink" title="默认输出（URL 字符串）"></a>默认输出（URL 字符串）</h3><pre><code class="typescript">import img from &#39;./pic.jpg?w=400&amp;format=webp&#39;
// 类型：string
// 值：&quot;/assets/pic.hash.webp&quot;
// 用途：直接用作 img src</code></pre>
<h3 id="as-srcset-响应式图片集"><a href="#as-srcset-响应式图片集" class="headerlink" title="as=srcset - 响应式图片集"></a><code>as=srcset</code> - 响应式图片集</h3><pre><code class="typescript">import &#123; srcset &#125; from &#39;./pic.jpg?w=400;800;1200&amp;format=webp&amp;as=srcset&#39;
// 类型：string
// 值：&quot;/assets/pic-400.hash.webp 400w, /assets/pic-800.hash.webp 800w, /assets/pic-1200.hash.webp 1200w&quot;
// 用途：img 标签的 srcset 属性</code></pre>
<h3 id="as-metadata-图片元信息"><a href="#as-metadata-图片元信息" class="headerlink" title="as=metadata - 图片元信息"></a><code>as=metadata</code> - 图片元信息</h3><pre><code class="typescript">import &#123; metadata &#125; from &#39;./pic.jpg?w=400&amp;as=metadata&#39;
// 类型：&#123; src: string, width: number, height: number, format: string &#125;
// 值：&#123; src: &quot;/assets/pic.hash.webp&quot;, width: 400, height: 300, format: &quot;webp&quot; &#125;
// 用途：获取处理后的图片信息</code></pre>
<h3 id="as-img-图片对象"><a href="#as-img-图片对象" class="headerlink" title="as=img - 图片对象"></a><code>as=img</code> - 图片对象</h3><pre><code class="typescript">import img from &#39;./pic.jpg?w=400&amp;as=img&#39;
// 类型：&#123; src: string, w: number, h: number &#125;
// 值：&#123; src: &quot;/assets/pic.hash.webp&quot;, w: 400, h: 300 &#125;
// 用途：同时获取 URL 和尺寸信息</code></pre>
<h3 id="as-picture-Picture-元素数据"><a href="#as-picture-Picture-元素数据" class="headerlink" title="as=picture - Picture 元素数据"></a><code>as=picture</code> - Picture 元素数据</h3><pre><code class="typescript">import picture from &#39;./pic.jpg?format=webp;avif;jpg&amp;w=800&amp;as=picture&#39;
// 类型：&#123; sources: Record&lt;string, string&gt;, img: &#123; src: string, w: number, h: number &#125; &#125;
// 值：&#123;
//   sources: &#123;
//     webp: &quot;/assets/pic.hash.webp 800w&quot;,
//     avif: &quot;/assets/pic.hash.avif 800w&quot;
//   &#125;,
//   img: &#123; src: &quot;/assets/pic.hash.jpg&quot;, w: 800, h: 600 &#125;
// &#125;
// 用途：生成 &lt;picture&gt; 元素</code></pre>
<h2 id="🚀-实际使用示例"><a href="#🚀-实际使用示例" class="headerlink" title="🚀 实际使用示例"></a>🚀 实际使用示例</h2><h3 id="1-基础-WebP-转换"><a href="#1-基础-WebP-转换" class="headerlink" title="1. 基础 WebP 转换"></a>1. 基础 WebP 转换</h3><pre><code class="vue">&lt;template&gt;
  &lt;img
    :src=&quot;heroImage&quot;
    alt=&quot;Hero image&quot;
  /&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// 将 PNG 转换为 WebP 格式
import heroImage from &#39;@/assets/images/hero.png?format=webp&amp;quality=85&#39;
&lt;/script&gt;</code></pre>
<h3 id="2-响应式图像"><a href="#2-响应式图像" class="headerlink" title="2. 响应式图像"></a>2. 响应式图像</h3><pre><code class="vue">&lt;template&gt;
  &lt;img
    :srcset=&quot;srcset&quot;
    sizes=&quot;(max-width: 600px) 300px, 600px&quot;
    alt=&quot;Responsive image&quot;
  /&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// 生成多种尺寸的 WebP 图像
import &#123; srcset &#125; from &#39;@/assets/images/banner.png?w=300;600;900&amp;format=webp&amp;quality=85&#39;
&lt;/script&gt;</code></pre>
<h3 id="3-多格式支持"><a href="#3-多格式支持" class="headerlink" title="3. 多格式支持"></a>3. 多格式支持</h3><pre><code class="vue">&lt;template&gt;
  &lt;picture&gt;
    &lt;source
      :srcset=&quot;avifSrcset&quot;
      type=&quot;image/avif&quot;
    /&gt;
    &lt;source
      :srcset=&quot;webpSrcset&quot;
      type=&quot;image/webp&quot;
    /&gt;
    &lt;img
      :src=&quot;fallbackSrc&quot;
      alt=&quot;Multi-format image&quot;
    /&gt;
  &lt;/picture&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// 生成 WebP 和 AVIF 格式
import &#123; srcset as webpSrcset &#125; from &#39;@/assets/images/photo.png?format=webp&amp;quality=85&amp;w=300;600&#39;
import &#123; srcset as avifSrcset &#125; from &#39;@/assets/images/photo.png?format=avif&amp;quality=80&amp;w=300;600&#39;
import fallbackSrc from &#39;@/assets/images/photo.png?w=600&#39;
&lt;/script&gt;</code></pre>
<h3 id="4-渐进式-WebP-图像"><a href="#4-渐进式-WebP-图像" class="headerlink" title="4. 渐进式 WebP 图像"></a>4. 渐进式 WebP 图像</h3><pre><code class="vue">&lt;template&gt;
  &lt;img
    :src=&quot;progressiveImage&quot;
    alt=&quot;Progressive WebP&quot;
  /&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// 生成渐进式 WebP 图像
import progressiveImage from &#39;@/assets/images/large-image.png?format=webp&amp;quality=85&amp;progressive=true&#39;
&lt;/script&gt;</code></pre>
<h3 id="5-背景图像优化"><a href="#5-背景图像优化" class="headerlink" title="5. 背景图像优化"></a>5. 背景图像优化</h3><pre><code class="vue">&lt;template&gt;
  &lt;div
    class=&quot;hero-bg&quot;
    :style=&quot;&#123; backgroundImage: `url($&#123;bgImage&#125;)` &#125;&quot;
  &gt;&lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// 优化背景图像
import bgImage from &#39;@/assets/images/background.png?format=webp&amp;quality=80&amp;w=1920&#39;
&lt;/script&gt;</code></pre>
<h3 id="6-高级用法：Picture-元素"><a href="#6-高级用法：Picture-元素" class="headerlink" title="6. 高级用法：Picture 元素"></a>6. 高级用法：Picture 元素</h3><pre><code class="vue">&lt;template&gt;
  &lt;picture&gt;
    &lt;source
      v-for=&quot;(srcset, format) in modernSources&quot;
      :key=&quot;format&quot;
      :srcset=&quot;srcset&quot;
      :type=&quot;`image/$&#123;format&#125;`&quot;
    /&gt;
    &lt;img
      :src=&quot;img.src&quot;
      :width=&quot;img.w&quot;
      :height=&quot;img.h&quot;
      alt=&quot;Banner&quot;
    /&gt;
  &lt;/picture&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; sources as modernSources, img &#125; from &#39;@/assets/hero.jpg?format=webp;avif&amp;w=800&amp;as=picture&#39;
&lt;/script&gt;</code></pre>
<h2 id="📊-性能影响对比"><a href="#📊-性能影响对比" class="headerlink" title="📊 性能影响对比"></a>📊 性能影响对比</h2><h3 id="文件大小对比（以-1MB-原始-JPEG-为例）"><a href="#文件大小对比（以-1MB-原始-JPEG-为例）" class="headerlink" title="文件大小对比（以 1MB 原始 JPEG 为例）"></a>文件大小对比（以 1MB 原始 JPEG 为例）</h3><table>
<thead>
<tr>
<th>配置</th>
<th>输出大小</th>
<th>质量</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td><code>?format=webp&amp;quality=90</code></td>
<td>~400KB</td>
<td>优秀</td>
<td>高质量展示</td>
</tr>
<tr>
<td><code>?format=webp&amp;quality=85</code></td>
<td>~300KB</td>
<td>很好</td>
<td>通用场景</td>
</tr>
<tr>
<td><code>?format=webp&amp;quality=75</code></td>
<td>~200KB</td>
<td>良好</td>
<td>缩略图</td>
</tr>
<tr>
<td><code>?format=avif&amp;quality=85</code></td>
<td>~250KB</td>
<td>很好</td>
<td>现代浏览器</td>
</tr>
<tr>
<td><code>?w=400&amp;format=webp&amp;quality=85</code></td>
<td>~50KB</td>
<td>很好</td>
<td>小尺寸图片</td>
</tr>
</tbody></table>
<h3 id="构建时间影响"><a href="#构建时间影响" class="headerlink" title="构建时间影响"></a>构建时间影响</h3><table>
<thead>
<tr>
<th>操作</th>
<th>相对耗时</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>格式转换</td>
<td>1x</td>
<td>基础操作</td>
</tr>
<tr>
<td>尺寸调整</td>
<td>1.2x</td>
<td>轻微增加</td>
</tr>
<tr>
<td>多尺寸生成</td>
<td>2-3x</td>
<td>按尺寸数量倍增</td>
</tr>
<tr>
<td>多格式输出</td>
<td>2-4x</td>
<td>按格式数量倍增</td>
</tr>
<tr>
<td>复杂滤镜</td>
<td>1.5-2x</td>
<td>模糊、色调等</td>
</tr>
</tbody></table>
<h2 id="💡-最佳实践"><a href="#💡-最佳实践" class="headerlink" title="💡 最佳实践"></a>💡 最佳实践</h2><h3 id="1-选择合适的图片"><a href="#1-选择合适的图片" class="headerlink" title="1. 选择合适的图片"></a>1. 选择合适的图片</h3><ul>
<li><strong>重要图片</strong>：使用 imagetools 进行格式转换</li>
<li><strong>普通图片</strong>：依赖 vite-plugin-image-optimizer 进行压缩</li>
</ul>
<h3 id="2-质量设置"><a href="#2-质量设置" class="headerlink" title="2. 质量设置"></a>2. 质量设置</h3><ul>
<li><strong>WebP</strong>: <code>quality=85</code> 是视觉无损的最佳平衡点</li>
<li><strong>AVIF</strong>: <code>quality=80</code> 提供更好的压缩率</li>
</ul>
<h3 id="3-响应式图像"><a href="#3-响应式图像" class="headerlink" title="3. 响应式图像"></a>3. 响应式图像</h3><ul>
<li>为不同设备生成合适的尺寸</li>
<li>使用 <code>sizes</code> 属性配合 <code>srcset</code></li>
</ul>
<h3 id="4-降级方案"><a href="#4-降级方案" class="headerlink" title="4. 降级方案"></a>4. 降级方案</h3><ul>
<li>使用 <code>&lt;picture&gt;</code> 标签提供多格式支持</li>
<li>确保有 PNG/JPG 格式的降级方案</li>
</ul>
<h3 id="5-基础配置推荐"><a href="#5-基础配置推荐" class="headerlink" title="5. 基础配置推荐"></a>5. 基础配置推荐</h3><pre><code class="typescript">// vite.config.mts
imagetools(&#123;
  defaultDirectives: new URLSearchParams(&#123;
    format: &#39;webp&#39;,
    quality: &#39;85&#39;,
    progressive: &#39;true&#39;,
  &#125;),
  removeMetadata: true,
&#125;)</code></pre>
<h3 id="6-按用途分类处理"><a href="#6-按用途分类处理" class="headerlink" title="6. 按用途分类处理"></a>6. 按用途分类处理</h3><pre><code class="typescript">// 英雄图片 - 高质量
import hero from &#39;@/assets/hero.jpg?format=webp&amp;quality=90&amp;w=1920&#39;

// 缩略图 - 小尺寸，低质量
import thumb from &#39;@/assets/photo.jpg?w=200&amp;h=200&amp;fit=cover&amp;quality=75&#39;

// 背景图 - 模糊，低质量
import bgBlur from &#39;@/assets/bg.jpg?blur=10&amp;quality=60&amp;w=1200&#39;

// 响应式图片
import &#123; srcset &#125; from &#39;@/assets/banner.jpg?w=400;800;1200&amp;format=webp&amp;as=srcset&#39;</code></pre>
<h2 id="🔧-项目配置"><a href="#🔧-项目配置" class="headerlink" title="🔧 项目配置"></a>🔧 项目配置</h2><h3 id="当前项目配置"><a href="#当前项目配置" class="headerlink" title="当前项目配置"></a>当前项目配置</h3><pre><code class="typescript">// vite.config.mts
imagetools(&#123;
  // 每张图片默认生效的指令，拼接默认参数
  defaultDirectives: new URLSearchParams(&#123;
    progressive: &#39;true&#39;,
  &#125;),
&#125;),</code></pre>
<h3 id="TypeScript-类型声明"><a href="#TypeScript-类型声明" class="headerlink" title="TypeScript 类型声明"></a>TypeScript 类型声明</h3><p>项目已在 <code>env.d.ts</code> 中配置了完整的 ImageTools 类型声明，支持所有查询参数的类型检查。</p>
<pre><code class="ts">// Imagetools 类型声明
declare module &#39;*.png?format=webp&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.jpg?format=webp&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.jpeg?format=webp&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.png?format=avif&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.jpg?format=avif&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.jpeg?format=avif&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.png?format=webp,avif&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.jpg?format=webp,avif&#39; &#123;
  const src: string
  export default src
&#125;

declare module &#39;*.jpeg?format=webp,avif&#39; &#123;
  const src: string
  export default src
&#125;

// 带尺寸参数的 WebP
declare module &#39;*.png?w=*&amp;format=webp&#39; &#123;
  const srcset: string
  export &#123; srcset &#125;
&#125;

declare module &#39;*.jpg?w=*&amp;format=webp&#39; &#123;
  const srcset: string
  export &#123; srcset &#125;
&#125;

declare module &#39;*.jpeg?w=*&amp;format=webp&#39; &#123;
  const srcset: string
  export &#123; srcset &#125;
&#125;

// 带尺寸参数的 AVIF
declare module &#39;*.png?w=*&amp;format=avif&#39; &#123;
  const srcset: string
  export &#123; srcset &#125;
&#125;

declare module &#39;*.jpg?w=*&amp;format=avif&#39; &#123;
  const srcset: string
  export &#123; srcset &#125;
&#125;

declare module &#39;*.jpeg?w=*&amp;format=avif&#39; &#123;
  const srcset: string
  export &#123; srcset &#125;
&#125;

// 通用查询参数支持
declare module &#39;*.png?*&#39; &#123;
  const src: string
  export default src
  export const srcset: string
  export const metadata: any
&#125;

declare module &#39;*.jpg?*&#39; &#123;
  const src: string
  export default src
  export const srcset: string
  export const metadata: any
&#125;

declare module &#39;*.jpeg?*&#39; &#123;
  const src: string
  export default src
  export const srcset: string
  export const metadata: any
&#125;

declare module &#39;*.webp?*&#39; &#123;
  const src: string
  export default src
  export const srcset: string
  export const metadata: any
&#125;

declare module &#39;*.avif?*&#39; &#123;
  const src: string
  export default src
  export const srcset: string
  export const metadata: any
&#125;</code></pre>
<h2 id="⚠️-注意事项"><a href="#⚠️-注意事项" class="headerlink" title="⚠️ 注意事项"></a>⚠️ 注意事项</h2><ol>
<li><strong>图片必须通过 import 导入</strong>：只有通过 ES6 import 导入的图片才会被 imagetools 处理</li>
<li><strong>Node.js 版本要求</strong>：最新版本的 imagetools 需要 Node.js 18+，当前项目使用兼容版本</li>
<li><strong>构建时间</strong>：复杂的图片处理会增加构建时间，建议合理使用</li>
<li><strong>文件大小权衡</strong>：过度优化可能导致质量损失，需要在文件大小和质量之间找到平衡</li>
</ol>
<h2 id="🌐-WebP-AVIF-浏览器兼容性"><a href="#🌐-WebP-AVIF-浏览器兼容性" class="headerlink" title="🌐 WebP/AVIF 浏览器兼容性"></a>🌐 WebP/AVIF 浏览器兼容性</h2><h3 id="WebP-支持"><a href="#WebP-支持" class="headerlink" title="WebP 支持"></a>WebP 支持</h3><ul>
<li><strong>Chrome</strong>: 23+</li>
<li><strong>Firefox</strong>: 65+</li>
<li><strong>Safari</strong>: 14+</li>
<li><strong>Edge</strong>: 18+</li>
</ul>
<h3 id="AVIF-支持"><a href="#AVIF-支持" class="headerlink" title="AVIF 支持"></a>AVIF 支持</h3><ul>
<li><strong>Chrome</strong>: 85+</li>
<li><strong>Firefox</strong>: 93+</li>
<li><strong>Safari</strong>: 16.1+</li>
<li><strong>Edge</strong>: 85+</li>
</ul>
<h3 id="移动端支持"><a href="#移动端支持" class="headerlink" title="移动端支持"></a>移动端支持</h3><ul>
<li><strong>iOS Safari</strong>: iOS 14+ 支持 WebP</li>
<li><strong>Android Chrome</strong>: 原生支持 WebP</li>
<li><strong>微信浏览器</strong>: 支持 WebP</li>
</ul>
<h3 id="文件大小对比"><a href="#文件大小对比" class="headerlink" title="文件大小对比"></a>文件大小对比</h3><ul>
<li><strong>WebP</strong>: 通常比 PNG 小 25-35%</li>
<li><strong>AVIF</strong>: 通常比 WebP 小 20-30%</li>
</ul>
<h2 id="📚-相关链接"><a href="#📚-相关链接" class="headerlink" title="📚 相关链接"></a>📚 相关链接</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/JonasKruckenberg/imagetools">ImageTools 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://sharp.pixelplumbing.com/">Sharp 文档</a></li>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/speed/webp">WebP 格式说明</a></li>
<li><a target="_blank" rel="noopener" href="https://web.dev/compress-images-avif/">AVIF 格式说明</a></li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" preload="auto" controls="controls"
                data-autoplay="true">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/statics/英雄的黎明.mp3'></li>
                
                    
                
                <li title='1' data-url='/statics/出埃及记.mp3'></li>
                
                    
                
                <li title='2' data-url='/statics/天地孤影任我行.mp3'></li>
                
                    
                
                <li title='3' data-url='/statics/市集.mp3'></li>
                
                    
                
                <li title='4' data-url='/statics/知音.mp3'></li>
                
                    
                
                <li title='5' data-url='/statics/Beautiful In White.mp3'></li>
                
                    
                
                <li title='6' data-url='/statics/chengdu.mp3'></li>
                
                    
                
                <li title='7' data-url='/statics/平凡之路.mp3'></li>
                
                    
            </ul>
            
            
            <div class="post-nav">
                <hr>
                
                
                    <div class="post-nav-item">下一篇：<a href="/2025/04/17/lowcode/core/behavior/" rel="next" 
                        title="低代码核心实现 - 组件间数据和行为交互">低代码核心实现 - 组件间数据和行为交互</a></div>
                                
            </div>   
                        
            
            
    <div id='gitalk-container' class="comment link"
        data-ae='true'
        data-ci='1fa2cbcaf1ea94926f9e'
        data-cs='d3c54315ace2f651c0c623c4169318771e377e97'
        data-r='blog.eleven.net.cn'
        data-o='eleven-net-cn'
        data-a='eleven-net-cn'
        data-d='true'
    >留言</div>


            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img class="author-pic" src="/img/abc/eleven-net-cn.jpeg" height=300 width=300></img>
                    <div class="span-wrapper">
                        <a href="https://github.com/eleven-net-cn" target="_blank">
                            <span class=" iconfont icon-github"></span>
                            <span>eleven-net-cn</span>
                        </a>
                    </div>
                    <p></p>
                    <!-- 更多社交账号 -->
                    <!-- <span></span>
                    <dl>
                        <dd><a href="https://github.com/eleven-net-cn" target="_blank"><span
                                    class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="https://twitter.com/TriDiamond6" target="_blank"><span
                                    class=" iconfont icon-twitter"></span></a></dd>
                        <dd><a href="" target="_blank"><span
                                    class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl> -->
                </div>
                <ul>
                    <li><a href="/">20 <p>文章</p></a></li>
                    <li><a href="/categories">13 <p>分类</p></a></li>
                    <li><a href="/tags">20 <p>标签</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>目录</h4>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%96-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">📖 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%8F%92%E4%BB%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">⚙️ 插件配置参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#include-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E8%A7%84%E5%88%99"><span class="toc-number">2.1.</span> <span class="toc-text">include - 文件包含规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exclude-%E6%96%87%E4%BB%B6%E6%8E%92%E9%99%A4%E8%A7%84%E5%88%99"><span class="toc-number">2.2.</span> <span class="toc-text">exclude - 文件排除规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defaultDirectives-%E9%BB%98%E8%AE%A4%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4"><span class="toc-number">2.3.</span> <span class="toc-text">defaultDirectives - 默认处理指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#removeMetadata-%E7%A7%BB%E9%99%A4%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">2.4.</span> <span class="toc-text">removeMetadata - 移除元数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#namedExports-%E5%91%BD%E5%90%8D%E5%AF%BC%E5%87%BA"><span class="toc-number">2.5.</span> <span class="toc-text">namedExports - 命名导出</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%AF-%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">🎯 查询参数详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%BA%E5%AF%B8%E6%8E%A7%E5%88%B6%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.</span> <span class="toc-text">尺寸控制参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.</span> <span class="toc-text">格式转换参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E8%A7%89%E6%95%88%E6%9E%9C%E5%8F%82%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">视觉效果参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E5%8F%82%E6%95%B0"><span class="toc-number">3.4.</span> <span class="toc-text">高级参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%A4-%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E8%AF%A6%E8%A7%A3"><span class="toc-number">4.</span> <span class="toc-text">📤 输出格式详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E8%BE%93%E5%87%BA%EF%BC%88URL-%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">默认输出（URL 字符串）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#as-srcset-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%9B%BE%E7%89%87%E9%9B%86"><span class="toc-number">4.2.</span> <span class="toc-text">as&#x3D;srcset - 响应式图片集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#as-metadata-%E5%9B%BE%E7%89%87%E5%85%83%E4%BF%A1%E6%81%AF"><span class="toc-number">4.3.</span> <span class="toc-text">as&#x3D;metadata - 图片元信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#as-img-%E5%9B%BE%E7%89%87%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.4.</span> <span class="toc-text">as&#x3D;img - 图片对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#as-picture-Picture-%E5%85%83%E7%B4%A0%E6%95%B0%E6%8D%AE"><span class="toc-number">4.5.</span> <span class="toc-text">as&#x3D;picture - Picture 元素数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E5%AE%9E%E9%99%85%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.</span> <span class="toc-text">🚀 实际使用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80-WebP-%E8%BD%AC%E6%8D%A2"><span class="toc-number">5.1.</span> <span class="toc-text">1. 基础 WebP 转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%9B%BE%E5%83%8F"><span class="toc-number">5.2.</span> <span class="toc-text">2. 响应式图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%9A%E6%A0%BC%E5%BC%8F%E6%94%AF%E6%8C%81"><span class="toc-number">5.3.</span> <span class="toc-text">3. 多格式支持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%B8%90%E8%BF%9B%E5%BC%8F-WebP-%E5%9B%BE%E5%83%8F"><span class="toc-number">5.4.</span> <span class="toc-text">4. 渐进式 WebP 图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%83%8C%E6%99%AF%E5%9B%BE%E5%83%8F%E4%BC%98%E5%8C%96"><span class="toc-number">5.5.</span> <span class="toc-text">5. 背景图像优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95%EF%BC%9APicture-%E5%85%83%E7%B4%A0"><span class="toc-number">5.6.</span> <span class="toc-text">6. 高级用法：Picture 元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8A-%E6%80%A7%E8%83%BD%E5%BD%B1%E5%93%8D%E5%AF%B9%E6%AF%94"><span class="toc-number">6.</span> <span class="toc-text">📊 性能影响对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%AF%B9%E6%AF%94%EF%BC%88%E4%BB%A5-1MB-%E5%8E%9F%E5%A7%8B-JPEG-%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">6.1.</span> <span class="toc-text">文件大小对比（以 1MB 原始 JPEG 为例）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E6%97%B6%E9%97%B4%E5%BD%B1%E5%93%8D"><span class="toc-number">6.2.</span> <span class="toc-text">构建时间影响</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%92%A1-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">7.</span> <span class="toc-text">💡 最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">7.1.</span> <span class="toc-text">1. 选择合适的图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B4%A8%E9%87%8F%E8%AE%BE%E7%BD%AE"><span class="toc-number">7.2.</span> <span class="toc-text">2. 质量设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%9B%BE%E5%83%8F"><span class="toc-number">7.3.</span> <span class="toc-text">3. 响应式图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%99%8D%E7%BA%A7%E6%96%B9%E6%A1%88"><span class="toc-number">7.4.</span> <span class="toc-text">4. 降级方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%E6%8E%A8%E8%8D%90"><span class="toc-number">7.5.</span> <span class="toc-text">5. 基础配置推荐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%8C%89%E7%94%A8%E9%80%94%E5%88%86%E7%B1%BB%E5%A4%84%E7%90%86"><span class="toc-number">7.6.</span> <span class="toc-text">6. 按用途分类处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%A7-%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE"><span class="toc-number">8.</span> <span class="toc-text">🔧 项目配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE"><span class="toc-number">8.1.</span> <span class="toc-text">当前项目配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TypeScript-%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E"><span class="toc-number">8.2.</span> <span class="toc-text">TypeScript 类型声明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%A0%EF%B8%8F-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">9.</span> <span class="toc-text">⚠️ 注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8C%90-WebP-AVIF-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-number">10.</span> <span class="toc-text">🌐 WebP&#x2F;AVIF 浏览器兼容性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WebP-%E6%94%AF%E6%8C%81"><span class="toc-number">10.1.</span> <span class="toc-text">WebP 支持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AVIF-%E6%94%AF%E6%8C%81"><span class="toc-number">10.2.</span> <span class="toc-text">AVIF 支持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%94%AF%E6%8C%81"><span class="toc-number">10.3.</span> <span class="toc-text">移动端支持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%AF%B9%E6%AF%94"><span class="toc-number">10.4.</span> <span class="toc-text">文件大小对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%9A-%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5"><span class="toc-number">11.</span> <span class="toc-text">📚 相关链接</span></a></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p class="copyright gradient-text" id="copyright">
        &copy;&nbsp;2020&nbsp;-&nbsp;2025
        <span>
            eleven-net-cn
        </span>
    </p>
    <p class="gradient-text">
        <a href=https://beian.miit.gov.cn target="_blank">沪ICP备2022012323号-1</a>
    </p>
</footer>

<!-- <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/mathjax/2.7.6/MathJax.js"> -->
</script>

<script src="/js/MathJax.min.js"></script>

<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>


 
<link rel="stylesheet" href="/plugins/gitalk/gitalk.css">
 
<script src="/plugins/gitalk/gitalk.min.js"></script>
  
<script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="/js/search.js"></script>
 
<script src="/js/typed.min.js"></script>
 
<script src="/js/md5.min.js"></script>
 
<script src="/js/social-share-1.0.16.min.js"></script>
 
<script src="/codemirror-5.60.0/lib/codemirror.js"></script>
  
<script src="/codemirror-5.60.0/mode/javascript/javascript.js"></script>
  
<script src="/codemirror-5.60.0/mode/css/css.js"></script>
  
<script src="/codemirror-5.60.0/mode/sass/sass.js"></script>
  
<script src="/codemirror-5.60.0/mode/xml/xml.js"></script>
  
<script src="/codemirror-5.60.0/mode/htmlmixed/htmlmixed.js"></script>
  
<script src="/codemirror-5.60.0/mode/clike/clike.js"></script>
  
<script src="/codemirror-5.60.0/mode/php/php.js"></script>
  
<script src="/codemirror-5.60.0/mode/shell/shell.js"></script>
  
<script src="/codemirror-5.60.0/mode/python/python.js"></script>
   
<link rel="stylesheet" href="/plugins/photoswipe/photoswipe.min.css">
<link rel="stylesheet" href="/plugins/photoswipe/default-skin.min.css">


<script src="/plugins/photoswipe/photoswipe.min.js"></script>
<script src="/plugins/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
  

<script>
  /**
   * 打字效果
   */
  function initialTyped() {
    var typedTextEl = $('.typed-text');
    if (typedTextEl && typedTextEl.length > 0) {
      var typed = new Typed('.typed-text', {
        strings: ['', ''],
        typeSpeed: 90,
        loop: true,
        loopCount: Infinity,
        backSpeed: 20,
      });
    }
  }

  if ($('.article-header') && $('.article-header').length) {
    $(document).ready(function () {
      // 初始化打字机
      initialTyped();
    });
  }
</script>

 
<script src="/js/valine.min.js"></script>

<script>
  var valine = new Valine();

  function initValine(path) {
    if (!path) path = window.location.pathname;
    let language = 'zh-CN';
    if (!language) {
      language = 'en';
    } else {
      language = language.toLowerCase();
    }
    valine.init({
      el: '#vcomments',
      appId: 'hkm8dtO9l1LGafjtOfx8tvBd-gzGzoHsz',
      appKey: 'UOfcRu89reXtwqeIXPzpMYMj',
      notify: 'true',
      verify: 'false',
      avatar: 'mp',
      placeholder: '输入评论...',
      visitor: 'true',
      path: path,
      lang: language,
    });
  }

  $(document).ready(function () {
    initValine();
  });
</script>





</html>
